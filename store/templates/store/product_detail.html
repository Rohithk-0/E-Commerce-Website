{% extends 'store/layouts/main.html' %}
{% block title %}{{ product.name }} | ANOMIE{% endblock %}

{% block content %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

  body {
    font-family: 'Roboto', sans-serif;
    background: #f4f7fb;
    margin: 0;
    padding: 0;
  }

  .product-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: flex-start;
    gap: 50px;
    max-width: 1200px;
    margin: 40px auto;
    padding: 20px;
    animation: fadeInUp 1s ease-out;
  }

  .product-image {
    flex: 1 1 400px;
    max-width: 400px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
  }

  .product-image img {
    width: 100%;
    height: 400px;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .product-image:hover img {
    transform: scale(1.05);
  }

  .product-info {
    flex: 1 1 400px;
    max-width: 500px;
    background: #fff;
    padding: 30px 40px;
    border-radius: 20px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    animation: fadeInRight 1s ease-out;
  }

  .product-info h2 {
    font-size: 2em;
    color: #111;
    margin-bottom: 15px;
  }

  .product-info p {
    color: #555;
    margin-bottom: 15px;
    line-height: 1.6;
  }

  .product-info button {
    padding: 12px 25px;
    border-radius: 50px;
    border: none;
    background: #111;
    color: #fff;
    font-size: 1em;
    margin: 5px 10px 15px 0;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .product-info button:hover {
    background: #444;
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  }

  form select {
    padding: 10px 15px;
    border-radius: 50px;
    border: 1px solid #ccc;
    margin-right: 10px;
    outline: none;
    transition: all 0.3s ease;
  }

  form select:focus {
    border-color: #111;
    box-shadow: 0 0 10px rgba(17,17,17,0.3);
    transform: scale(1.02);
  }

  form button {
    padding: 10px 20px;
    border-radius: 50px;
    border: none;
    background: #111;
    color: #fff;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  form button:hover {
    background: #444;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }

  .rating-info {
    margin-top: 15px;
    font-weight: 500;
    color: #111;
  }

  @keyframes fadeInUp {
    from {opacity:0; transform: translateY(50px);}
    to {opacity:1; transform: translateY(0);}
  }

  @keyframes fadeInRight {
    from {opacity:0; transform: translateX(50px);}
    to {opacity:1; transform: translateX(0);}
  }

  @media screen and (max-width: 900px) {
    .product-container {
      flex-direction: column;
      align-items: center;
    }

    .product-info, .product-image {
      max-width: 90%;
    }
  }
</style>

<div class="product-container">
  <div class="product-image">
    <img src="{{ product.image.url }}" alt="{{ product.name }}">
  </div>
  <div class="product-info">
    <h2>{{ product.name }}</h2>
    <p>{{ product.description }}</p>
    <p><strong>Price:</strong> ${{ product.price }}</p>

    <a href="{% url 'add_to_cart' product.id %}"><button>Add to Cart</button></a>
    <a href="{% url 'add_to_wishlist' product.id %}"><button>❤️ Add to Wishlist</button></a>

    <form action="{% url 'add_rating' product.id %}" method="POST" style="margin-top:15px;">
      {% csrf_token %}
      <label>Rate this product:</label>
      <select name="stars">
        {% for i in "12345" %}
          <option value="{{ i }}">{{ i }}⭐</option>
        {% endfor %}
      </select>
      <button type="submit">Submit Rating</button>
    </form>

    <p class="rating-info">
      ⭐ Average Rating: {{ product.ratings.all|length }} ratings,
      {% with avg=product.ratings.all|avg:'stars' %}
        {% if avg %}Average: {{ avg|floatformat:1 }}⭐{% else %}No ratings yet{% endif %}
      {% endwith %}
    </p>
  </div>
</div>

<script>
  // Optional subtle animation: fade-in product info
  const infoBox = document.querySelector('.product-info');
  infoBox.style.opacity = 0;
  infoBox.style.transform = 'translateX(50px)';
  setTimeout(() => {
    infoBox.style.transition = 'all 0.8s ease-out';
    infoBox.style.opacity = 1;
    infoBox.style.transform = 'translateX(0)';
  }, 100);
</script>
{% endblock %}
